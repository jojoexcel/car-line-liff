<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>使用指南</title>
   <!-- 1. 載入版本號和載入器 -->
    <script src="./js/version.js"></script>
    <script src="./js/loader.js"></script>

    <!-- 2. 動態載入 CSS -->
    <script>
        loadCSS('./css/style.css');
    </script>
    <style>
        /* 針對指南頁面的額外樣式 */
        .guide-container h1 {
            text-align: center;
            margin-bottom: 1.5em;
        }

        /* 【關鍵】details 標籤的樣式 */
        details {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            margin-bottom: 15px;
            /* 讓展開動畫更流暢 */
            transition: background-color 0.3s;
        }

        /* 【關鍵】summary 標籤 (也就是標題) 的樣式 */
        summary {
            font-size: 1.2em;
            font-weight: 600;
            padding: 15px 20px;
            cursor: pointer;
            position: relative;
            outline: none; /* 移除點擊時的藍色外框 */
            list-style: none; /* 隱藏原生的小箭頭 */
        }

        /* 用偽元素自訂一個漂亮的箭頭 */
        summary::after {
            content: '▼';
            position: absolute;
            right: 20px;
            font-size: 0.8em;
            transition: transform 0.3s ease;
        }

        /* 當 details 標籤被展開時，改變箭頭方向 */
        details[open] > summary::after {
            transform: rotate(180deg);
        }

        /* 展開時改變標題背景色 */
        details[open] > summary {
            background-color: #e9ecef;
            border-bottom: 1px solid #dee2e6;
        }

        /* 【關鍵】展開後的內容區域樣式 */
        .details-content {
            padding: 20px;
            line-height: 1.8;
            color: #333;
            border-top: 1px solid #ddd;
        }

        .details-content ol { padding-left: 20px; }
        .details-content code { /* ... code 樣式保持不變 ... */ }
        .screenshot-placeholder { /* ... 截圖樣式保持不變 ... */ }
    </style>
</head>
<body>
    <div class="container guide-container">
        <h1>公務車借用系統 - 使用指南</h1>
        <p id="welcome-message" style="text-align: center; margin-bottom: 2em; color: #555;"></p>

        <!-- 手風琴結構開始 -->

        <details>
            <summary>1. 首次使用：建立個人資料</summary>
            <div class="details-content">
                <ol>
                    <li>點擊主選單或圖文選單中的「📝 個人資料」。</li>
                    <li>系統會自動帶入您的 LINE 名稱。請填寫您的「用戶名稱」(您的真實姓名)、「電話」、「單位」及「職務」。</li>
                    <li>填寫完畢後，點擊「建立新資料」。</li>
                    <li>您的帳號狀態將變為「待審核」，請靜待管理員審核通過後，即可使用借車相關功能。</li>
                </ol>
<!--                 <div class="screenshot-placeholder">【個人資料填寫畫面截圖】</div> -->
            </div>
        </details>

        <details>
            <summary>2. 預約借車</summary>
            <div class="details-content">
                <ol>
                    <li>點擊「📅 預約借車」。</li>
                    <li>在「開始時間」與「結束時間」欄位，點擊並選擇您要借用的日期與時間。</li>
                    <li>點擊「查詢可用車輛」。</li>
                    <li>系統會列出該時段所有可用的車輛。請點選您要預約的車輛。</li>
                    <li>填寫「申請事由」與「起訖地點」。</li>
                    <li>點擊「確認預約」，即完成預約程序。</li>
                </ol>
<!--                 <div class="screenshot-placeholder">【預約流程畫面截圖】</div> -->
            </div>
        </details>

        <details>
            <summary>3. 領車 / 還車</summary>
            <div class="details-content">
                <ol>
                    <li>在您預約的時間範圍內，點擊「🔑 領車 / 還車」。</li>
                    <li>系統會自動判斷您當前的狀態，並可能請您選擇要操作的車輛。</li>
                    <li>依照畫面提示，填寫「目前公里數」。還車時，可填「加油金額」。</li>
                    <li>有任何異常可填備註。</li>
                    <li>點擊「確認領車」或「確認還車」完成操作。</li>
                </ol>
            </div>
        </details>

        <details>
            <summary>4.上傳拍照 (領/還車後)</summary>
            <div class="details-content">
                <ol>
                    <li>完成領車或還車後，建議立即拍照存證。</li>
                    <li>點擊「📷 上傳拍照」。</li>
                    <li>頁面會自動鎖定您**最後一筆**領/還車記錄。</li>
                    <li>點擊「選擇照片」，從相簿選擇照片 (最多5張)。</li>
                    <li>確認照片預覽無誤後，點擊「上傳照片」。</li>
                </ol>
            </div>
        </details>

        <details>
            <summary>5. 其他功能與常見問題</summary>
            <div class="details-content">
                <h4>查詢我的預約</h4>
                <p>點擊「🔍 查詢我的預約」，可查看您所有有效的預約。對於尚未領車的預約，您可以在此頁面進行取消。</p>
                <h4>修改歷史記錄</h4>
                <p>點擊「✍️ 修改歷史記錄」，可以修改過去一週內的領還車記錄，例如補填或修正公里數、加油金額、備註等。</p>
                <hr style="margin: 20px 0;">
                <h4>Q: 為什麼我無法預約借車？</h4>
                <p>A: 請先至「個人資料」頁面確認您的帳號狀態是否為「通過」。若為「待審核」或「停權」，則無法使用借車功能。</p>
                <h4>Q: 為什麼「領車/還車」頁面顯示我沒有可操作的項目？</h4>
                <p>A: 請確認您當前的時間是否在預約的「可操作時間範圍」內。一般可於預約開始前 2 小時領車。若預約時間在早上 8 點前，則可於前一天下午 5 點後領車。</p>
            </div>
        </details>

        <!-- 手風琴結構結束 -->
    </div>

    <!-- JavaScript 部分保持不變 -->
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script>
        // 這個頁面的 JS 邏輯不變，只需要簡單的 LIFF 初始化
        async function initializeGuidePage() {
            try {
                await liff.init({ liffId: '2007626718-yQALkZm8' });
                if (liff.isLoggedIn()) {
                    const profile = await liff.getProfile();
                    const welcomeEl = document.getElementById('welcome-message');
                    if (welcomeEl) {
                        welcomeEl.textContent = `歡迎，${profile.displayName}！點擊標題可展開或收合說明。`;
                    }
                }
            } catch (error) {
                console.error('LIFF initialization failed', error);
            }
        }
        initializeGuidePage();
    </script>
</body>
</html>
